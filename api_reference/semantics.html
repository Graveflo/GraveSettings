<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Handler Objects" href="handlers.html" /><link rel="prev" title="API Reference" href="../api_reference.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Semantics - grave_settings 0.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">grave_settings 0.1.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">grave_settings 0.1.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Directory</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../limitations.html">Limitations</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../limitations/security_concerns.html">Security Concerns</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api_reference.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="handlers.html">Handler Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="formatters.html">Formatters</a></li>
<li class="toctree-l2"><a class="reference internal" href="bases.html">User Object Base Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="conversion_manager.html">Conversion Manager</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/settings_base_classes.html">Settings Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/using_config_file.html">Config File Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/preserving_references.html">Preserving References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/circular_references.html">Circular References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/using_handlers.html">Using Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/building_a_formatter.html">Custom Formatter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.abstract.html">abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.base.html">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.config_file.html">config_file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.conversion_manager.html">conversion_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.default_handlers.html">default_handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.formatter.html">formatter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.formatter_settings.html">formatter_settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.framestack_context.html">framestack_context</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.handlers.html">handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.helper_objects.html">helper_objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.semantics.html">semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.utilities.html">utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/grave_settings.validation.html">validation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/modules.html">Formatters</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="semantics">
<h1>Semantics<a class="headerlink" href="#semantics" title="Permalink to this heading">#</a></h1>
<p>Semantics provide a simple mechanism for objects to communicate with the formatter during processing. Semantics are not guaranteed to be supported by all formatters and thus custom formatters should not have to implement all or any of the semantics. You can also make custom semantics and use them wherever you want. Objects that work with semantics should always accept any semantic that is given to them but they do not have to actually use them. The built in formatters should support all semantics where applicable.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<p>Semantics are just objects that wrap another object. Each semantic has a specific meaning that is implied from it’s unique type and the encapsulated data is like a setting value. Creating a semantic will look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Semantic</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a semantic of type Semantic with the value True. Of course, real semantics will be a subclass of Semantic and the subclass should define its encapsulating type by means of the generic typing of Semantic. For example this is the definition of a Semantic used in this module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Indentation</span><span class="p">(</span><span class="n">Semantic</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
</pre></div>
</div>
<p>This is the <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Indentation" title="grave_settings.semantics.Indentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Indentation</span></code></a> semantic and it specifies the type int to the generic class. This means that you are meant to create Indentation semantics like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Indentation</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="grouping-and-interactions">
<h2>Grouping and Interactions<a class="headerlink" href="#grouping-and-interactions" title="Permalink to this heading">#</a></h2>
<p>There are two distinct kinds of Semantics and they are not differentiated by their class but instead the value of the class variable COLLECTION. <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Semantic" title="grave_settings.semantics.Semantic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Semantic</span></code></a> (the base class of all semantics) sets this value to <code class="xref py py-class docutils literal notranslate"><span class="pre">None</span></code> meaning that, by default, semantics do not stack and instead overwrite each-other.</p>
<p>This means that adding the same semantic type to something like a <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Semantics" title="grave_settings.semantics.Semantics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Semantics</span></code></a> object, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grave_settings.semantics</span> <span class="kn">import</span> <span class="n">Indentation</span><span class="p">,</span> <span class="n">Semantics</span>

<span class="n">semantics</span> <span class="o">=</span> <span class="n">Semantics</span><span class="p">()</span>
<span class="n">semantics</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">Indentation</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">semantics</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">Indentation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">semantics</span><span class="p">[</span><span class="n">Indentation</span><span class="p">])</span>
</pre></div>
</div>
<p>The value printed will be 5.</p>
<p>If the COLLECTION variable is not <code class="xref py py-class docutils literal notranslate"><span class="pre">None</span></code> then it is assumed that semantics of that type are meant to stack instead of overwriting each other and the collection that holds them will be instantiated from the type COLLECTION is set to. The value of COLLECTION should be a type and <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Semantic" title="grave_settings.semantics.Semantic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Semantic</span></code></a> has some methods that can be overriden if this type happens to be incompatible with the interface of the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> class. Here is an example showing how stacking semantics work:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grave_settings.semantics</span> <span class="kn">import</span> <span class="n">Semantics</span><span class="p">,</span> <span class="n">Semantic</span>


<span class="k">class</span> <span class="nc">SomeSemantic</span><span class="p">(</span><span class="n">Semantic</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="n">COLLECTION</span> <span class="o">=</span> <span class="nb">set</span>


<span class="n">semantics</span> <span class="o">=</span> <span class="n">Semantics</span><span class="p">()</span>
<span class="n">semantics</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">semantics</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">semantics</span><span class="p">[</span><span class="n">SomeSemantic</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="ow">in</span> <span class="n">semantics</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="ow">in</span> <span class="n">semantics</span><span class="p">)</span>
</pre></div>
</div>
<p>This will print:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span><span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">SomeSemantic</span><span class="p">(</span><span class="mi">5</span><span class="p">)}</span>
  <span class="kc">True</span>
  <span class="kc">True</span>
</pre></div>
</div>
</div>
<p>Showing that stacking semantics are stored in a collection (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a> in this case) and multiple values can be “in” the collection at a given time.</p>
</section>
<section id="integration">
<h2>Integration<a class="headerlink" href="#integration" title="Permalink to this heading">#</a></h2>
<p>Simple enough, but why and how are semantics actually used? The formatter, or more specifically <a class="reference internal" href="../api/grave_settings.formatter.html#grave_settings.formatter.Processor" title="grave_settings.formatter.Processor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Processors</span></code></a> in the default configurations, accept, view and manipulate semantics. Semantics are meant to function on a “stack” the same way we think about a recursive process. In this way of thinking we have what are referred to as “frame semantics” as well as the regular “semantics.” Semantics will propagate in depth, but not in breadth, meaning that if an object adds a semantic to the process it will stay there unless is it removed or overriden down stream. When a frame is “popped” the state of the semantics are restored to their configuration before the “push.” Frame semantics only effect the current recursion frame and do not effect either depth or breadth. The object that is responsible for managing this stack-like behavior is <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.SemanticContext" title="grave_settings.semantics.SemanticContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemanticContext</span></code></a> or in an actual formatter its subclass <a class="reference internal" href="../api/grave_settings.framestack_context.html#grave_settings.framestack_context.FrameStackContext" title="grave_settings.framestack_context.FrameStackContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrameStackContext</span></code></a> which adds a <a class="reference internal" href="handlers.html"><span class="doc">handler</span></a> to the stack.</p>
<p><a class="reference internal" href="../api/grave_settings.formatter.html#grave_settings.formatter.Formatter" title="grave_settings.formatter.Formatter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formatters</span></code></a> allow you to set semantics that they will hold onto and insert into the root frame’s semantics (not frame semantics) and <a class="reference internal" href="../api/grave_settings.formatter.html#grave_settings.formatter.Processor" title="grave_settings.formatter.Processor"><code class="xref py py-class docutils literal notranslate"><span class="pre">processors</span></code></a> also set default semantics to the root frame. The formatter’s semantics are added after the processor’s defaults since the formatter’s semantics are empty by default. They are there for user convenience.</p>
<p>Objects have access to semantics during processing via the <a class="reference internal" href="../api/grave_settings.formatter_settings.html#grave_settings.formatter_settings.FormatterContext" title="grave_settings.formatter_settings.FormatterContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">FormatterContext</span></code></a> that is passed into specially named methods on objects: <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.check_in_serialization_context" title="grave_settings.abstract.Serializable.check_in_serialization_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_in_serialization_context</span></code></a>, <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.check_in_deserialization_context" title="grave_settings.abstract.Serializable.check_in_deserialization_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_in_deserialization_context</span></code></a>, <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.to_dict" title="grave_settings.abstract.Serializable.to_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_dict</span></code></a>, <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.from_dict" title="grave_settings.abstract.Serializable.from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dict</span></code></a></p>
<p>It’s important to note that the default formatters call <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.check_in_serialization_context" title="grave_settings.abstract.Serializable.check_in_serialization_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_in_serialization_context</span></code></a> and <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.check_in_deserialization_context" title="grave_settings.abstract.Serializable.check_in_deserialization_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_in_deserialization_context</span></code></a> before the item in question is handled, but <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.check_in_deserialization_context" title="grave_settings.abstract.Serializable.check_in_deserialization_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_in_deserialization_context</span></code></a> happens before the object even exists. This is because in the deserialization process, the object is instantiated during handling from format specific objects, where it is the other way around for serialization. <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.from_dict" title="grave_settings.abstract.Serializable.from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dict</span></code></a> and <a class="reference internal" href="../api/grave_settings.abstract.html#grave_settings.abstract.Serializable.to_dict" title="grave_settings.abstract.Serializable.to_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_dict</span></code></a> happen during the handling process if the <a class="reference internal" href="../api/grave_settings.default_handlers.html#module-grave_settings.default_handlers" title="grave_settings.default_handlers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">default</span> <span class="pre">handlers</span></code></a> are used.</p>
</section>
<section id="explanation-by-example">
<h2>Explanation by Example<a class="headerlink" href="#explanation-by-example" title="Permalink to this heading">#</a></h2>
<p>You can read a description of the available semantics here: <a class="reference internal" href="../api/grave_settings.semantics.html#module-grave_settings.semantics" title="grave_settings.semantics"><code class="xref py py-class docutils literal notranslate"><span class="pre">grave_settings.semantics</span></code></a></p>
<p>Lets looks at the <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.AutoKeySerializableDictType" title="grave_settings.semantics.AutoKeySerializableDictType"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoKeySerializableDictType</span></code></a> semantic. This will tell the formatter which type to use for automatic conversion from a dictionary. This is needed when the file format does not support dictionary keys of arbitrary types. For example: JSON strings will only accept strings as their dictionary keys but python can have a dictionary keyed by arbitrary python objects. The default formatter will respond to this semantic and scan each dictionary’s keys for a types that are not allowed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The types that are allowed to be dictionary keys are set in the <a class="reference internal" href="../api/grave_settings.formatter_settings.html#grave_settings.formatter_settings.FormatterSpec" title="grave_settings.formatter_settings.FormatterSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FormatterSpec</span></code></a> from the method <a class="reference internal" href="../api/grave_settings.formatter_settings.html#grave_settings.formatter_settings.FormatterSpec.get_attribute_types" title="grave_settings.formatter_settings.FormatterSpec.get_attribute_types"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_attribute_types</span></code></a> which by default looks at the class variable ATTRIBUTE. The supplied formatters like <code class="xref py py-class docutils literal notranslate"><span class="pre">JsonFormatter</span></code> already have the appropriate values set, and <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.AutoKeySerializableDictType" title="grave_settings.semantics.AutoKeySerializableDictType"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoKeySerializableDictType</span></code></a> is enabled by default.</p>
</div>
<p>Normally this semantic is either not present, meaning that the python objects will either never have invalid keys, or will be incompatible with formats that do not support their keys, or it will be set as a default value at the root frame and forgotten, letting it do it’s job when needed. Lets say we wanted to turn it on manually. In the following example we will:</p>
<ol class="arabic simple">
<li><p>Disable the semantic on the root frame thus overriding the default</p></li>
<li><p>Create a class that turns the semantic on</p></li>
<li><p>Observe the output of the serialization process</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grave_settings.abstract</span> <span class="kn">import</span> <span class="n">Serializable</span>
<span class="kn">from</span> <span class="nn">grave_settings.formatters.json</span> <span class="kn">import</span> <span class="n">JsonFormatter</span>
<span class="kn">from</span> <span class="nn">grave_settings.semantics</span> <span class="kn">import</span> <span class="n">AutoKeySerializableDictType</span><span class="p">,</span> <span class="n">Negate</span>
<span class="kn">from</span> <span class="nn">grave_settings.helper_objects</span> <span class="kn">import</span> <span class="n">KeySerializableDict</span>
<span class="kn">from</span> <span class="nn">grave_settings.formatter_settings</span> <span class="kn">import</span> <span class="n">FormatterContext</span>


<span class="k">class</span> <span class="nc">MyObject</span><span class="p">(</span><span class="n">Serializable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sa">b</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span>  <span class="c1"># [1]</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">check_in_serialization_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">FormatterContext</span><span class="p">):</span>
        <span class="n">context</span><span class="o">.</span><span class="n">add_semantic</span><span class="p">(</span><span class="n">AutoKeySerializableDictType</span><span class="p">(</span><span class="n">KeySerializableDict</span><span class="p">))</span>


<span class="n">formatter</span> <span class="o">=</span> <span class="n">JsonFormatter</span><span class="p">()</span>
<span class="n">formatter</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">Negate</span><span class="p">(</span><span class="n">AutoKeySerializableDictType</span><span class="p">))</span>  <span class="c1"># [2]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">MyObject</span><span class="p">()))</span>
</pre></div>
</div>
<div class="admonition-note-1 admonition">
<p class="admonition-title">Note: [1]</p>
<p>that the dictionary has a single key <code class="docutils literal notranslate"><span class="pre">b'foo'</span></code> which is of type <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>. This class is not serializable by  <a class="reference external" href="https://docs.python.org/3/library/json.html#module-json" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code></a>. Even though “foo” looks like a safe string there is no guarantee that an arbitrary byte buffer will cooperate with the file’s character encoding let alone differentiating the types.</p>
</div>
<div class="admonition-note-2 admonition">
<p class="admonition-title">Note: [2]</p>
<p>The use of <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Negate" title="grave_settings.semantics.Negate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Negate</span></code></a> here is usually not needed as the semantic manager classes usually provide a remove_semantic or similar method. <a class="reference internal" href="../api/grave_settings.semantics.html#grave_settings.semantics.Negate" title="grave_settings.semantics.Negate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Negate</span></code></a> can be used to remove a semantic like you see above but this is only really useful if the semantics are being added to a collection that will later merge into a semantic context</p>
</div>
<p>This will output:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">{</span>
      <span class="s2">&quot;__class__&quot;</span><span class="p">:</span> <span class="s2">&quot;__main__.MyObject&quot;</span><span class="p">,</span>
      <span class="s2">&quot;my_mapping&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;__class__&quot;</span><span class="p">:</span> <span class="s2">&quot;grave_settings.helper_objects.KeySerializableDict&quot;</span><span class="p">,</span>
          <span class="s2">&quot;kvps&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                  <span class="s2">&quot;__class__&quot;</span><span class="p">:</span> <span class="s2">&quot;builtins.tuple&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                          <span class="s2">&quot;__class__&quot;</span><span class="p">:</span> <span class="s2">&quot;builtins.bytes&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;hex&quot;</span><span class="p">:</span> <span class="s2">&quot;666f6f&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;bar&quot;</span>
                  <span class="p">]</span>
              <span class="p">}</span>
          <span class="p">]</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Now lets look at a method for turning the semantic on only for the dictionary as the above will propagate the semantic to all object downstream of MyObject.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grave_settings.abstract</span> <span class="kn">import</span> <span class="n">Serializable</span>
<span class="kn">from</span> <span class="nn">grave_settings.formatters.json</span> <span class="kn">import</span> <span class="n">JsonFormatter</span>
<span class="kn">from</span> <span class="nn">grave_settings.semantics</span> <span class="kn">import</span> <span class="n">AutoKeySerializableDictType</span><span class="p">,</span> <span class="n">Negate</span>
<span class="kn">from</span> <span class="nn">grave_settings.helper_objects</span> <span class="kn">import</span> <span class="n">KeySerializableDict</span>
<span class="kn">from</span> <span class="nn">grave_settings.formatter_settings</span> <span class="kn">import</span> <span class="n">FormatterContext</span><span class="p">,</span> <span class="n">AddSemantics</span>


<span class="k">class</span> <span class="nc">MyObject</span><span class="p">(</span><span class="n">Serializable</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">my_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sa">b</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">FormatterContext</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">my_mapping</span> <span class="o">=</span> <span class="n">AddSemantics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">my_mapping</span><span class="p">,</span> <span class="n">frame_semantics</span><span class="o">=</span><span class="p">{</span><span class="n">AutoKeySerializableDictType</span><span class="p">(</span><span class="n">KeySerializableDict</span><span class="p">)})</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;my_mapping&#39;</span><span class="p">:</span> <span class="n">my_mapping</span>
        <span class="p">}</span>


<span class="n">formatter</span> <span class="o">=</span> <span class="n">JsonFormatter</span><span class="p">()</span>
<span class="n">formatter</span><span class="o">.</span><span class="n">add_semantics</span><span class="p">(</span><span class="n">Negate</span><span class="p">(</span><span class="n">AutoKeySerializableDictType</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">formatter</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">MyObject</span><span class="p">()))</span>
</pre></div>
</div>
<p>The output is identical.</p>
<p>Let’s acknowledge that MyObject might as well just create instances of <a class="reference internal" href="../api/grave_settings.helper_objects.html#grave_settings.helper_objects.KeySerializableDict" title="grave_settings.helper_objects.KeySerializableDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">KeySerializableDict</span></code></a> in it’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">to_dict()</span></code> method explicitly instead of using semantics and then convert them back manually to regular objects. The semantic allows the formatter to decide if the transformation is necessary and makes the process automatic. This is the basic function of semantics.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="handlers.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Handler Objects</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../api_reference.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">API Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Ryan McConnell
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Semantics</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#grouping-and-interactions">Grouping and Interactions</a></li>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#explanation-by-example">Explanation by Example</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    </body>
</html>